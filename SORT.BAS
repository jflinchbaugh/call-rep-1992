   10 CLOSE:CLEAR:SCREEN 0:WIDTH 80:VIEW PRINT:COLOR 4,0,0:KEY OFF:CLS
   20 LNGTH=104
   30 KEY(10) ON:ON KEY(10) GOSUB 10000
   40 LOCATE 1,25:PRINT "CALL REPORT SORTING UTILITY v1.2";
   50 COLOR 9:LOCATE 2,33:PRINT "<F10> TO QUIT";
   60 VIEW PRINT 3 TO 24:COLOR 7
   70 INPUT "YEAR(YYYY): ",Y:IF Y<1985 THEN GOTO 70
   80 FILE$=RIGHT$(STR$(Y),4)+".FCR"
   90 OPEN FILE$ AS 1 LEN=LNGTH
  100 IF LOF(1)=0 THEN GOTO 10010
  110 FIELD 1,6 AS DF$,13 AS RAF$,1 AS CDF$,35 AS LF$,20 AS NF$,4 AS TOF$,4 AS TIF$,2 AS MF$,6 AS PDF$,2 AS PF$,1 AS TF$,1 AS KF$,1 AS S16F$,1 AS S21F$,1 AS S34F$,1 AS S35F$,1 AS S36F$,1 AS S41F$,1 AS S42F$,1 AS S44F$,1 AS SOF$
  115 COLOR 15
  120 FOR I=1 TO LOF(1)/LNGTH
  130 FOR J=I TO LOF(1)/LNGTH
  135 LOCATE 12,1,0:PRINT "COMPARING CALL";I;"TO";J;"        ";
  140 GET 1,I
  150 COMP1=VAL(LEFT$(DF$,4)+TOF$)
  160 GET 1,J
  170 COMP2=VAL(LEFT$(DF$,4)+TOF$)
  180 IF COMP1>COMP2 THEN GOSUB 20000
  190 NEXT J
  200 NEXT I
  210 BEEP:LOCATE 12,1:PRINT "SORT IS COMPLETE            ";
  220 FOR X=1 TO 5000:NEXT
  230 CLOSE
  240 GOTO 10
10000 VIEW PRINT:CLOSE:CLS:KEY ON:RUN"MENU.BAS"
10010 PRINT "THERE ARE NO CALLS IN THIS FILE!":BEEP
10020 FOR X=1 TO 5000:NEXT X
10030 CLOSE:KILL FILE$
10040 RETURN 10
20000 LOCATE 12,1,0:PRINT "SWAPPING";I;"WITH";J;"               ";
20005 D$=DF$
20010 RA$=RAF$
20020 CD$=CDF$
20030 L$=LF$
20040 N$=NF$
20050 TL$=TOF$
20060 TI$=TIF$
20070 M$=MF$
20080 PD$=PDF$
20090 P$=PF$
20100 T$=TF$
20110 K$=KF$
20120 GET 1,I
20130 PUT 1,J
20140 LSET DF$=D$
20150 LSET RAF$=RA$
20160 LSET CDF$=CD$
20170 LSET LF$=L$
20180 LSET NF$=N$
20190 LSET TOF$=TL$
20200 LSET TIF$=TI$
20210 LSET MF$=M$
20220 LSET PDF$=PD$
20230 LSET PF$=P$
20240 LSET TF$=T$
20250 LSET KF$=K$
20260 PUT 1,I
20270 RETURN
